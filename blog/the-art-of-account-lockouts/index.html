<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.9.1"><title>The Art of Account Lockouts</title><meta name="description" content="Client-Side Lockout **DoA** ( C not A ) , when an attacker forces the app to lock out a legitimate user permanently"><meta name="theme-color" content="#8c5cf5"><link rel="canonical" href="https://spectre.louisescher.dev/"><meta name="og:title" content="The Art of Account Lockouts"><meta name="og:description" content="Client-Side Lockout **DoA** ( C not A ) , when an attacker forces the app to lock out a legitimate user permanently"><meta name="og:image" content="/_astro/lock.BEAaoYfG.png"><meta name="og:url" content="https://spectre.louisescher.dev/"><meta name="og:locale" content="en"><meta name="og:type" content="article">
			<meta property="article:published_time" content="2025-06-12T19:00:00.000Z">
			<meta name="author" content="Mian"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="The Art of Account Lockouts"><meta name="twitter:description" content="Client-Side Lockout **DoA** ( C not A ) , when an attacker forces the app to lock out a legitimate user permanently"><meta name="twitter:image" content="/_astro/lock.BEAaoYfG.png"><style>article h1,article h2,article h3,article h4{scroll-margin:4rem;margin-top:2rem}article{line-height:1.6;min-width:0}article hr{height:1px;border:none;background-color:#353535}p:has(img){display:flex;align-items:center;justify-content:center;margin-top:1rem;margin-bottom:1rem}p img{max-width:100%}.toc-card{min-width:0}.toc-card ol{padding:0;display:flex;flex-direction:column;gap:.5rem;margin-bottom:0;list-style-type:none;position:relative}.toc-card ol li a{color:#c7c7c7;font-size:.925rem;padding:.25rem .5rem;box-decoration-break:clone;-webkit-box-decoration-break:clone}.toc-card ol li a:hover{color:#fff;text-decoration:none}.toc-li[data-depth="3"]{margin-left:1rem}.toc-li[data-depth="4"]{margin-left:2rem}.no-mt{margin-top:0}ol li a.active{color:#fff;background:var(--primary)}.left{height:100%;position:relative}.toc-card{position:sticky;top:2rem}.article-header{position:relative;width:100%;height:fit-content;scroll-margin-top:2rem}.header{display:flex;flex-direction:column;gap:.5rem;position:absolute;bottom:1.5rem;left:1rem;max-width:calc(100% - 3rem);z-index:2}.article-h1{margin-bottom:0;font-size:2em;background:#fff;padding:.25rem .675rem;box-decoration-break:clone;-webkit-box-decoration-break:clone;position:relative;line-height:1.2;display:inline;color:#000}.article-info{display:flex;flex-direction:row;gap:.5rem;font-family:Ghost Mono,monospace;background:#fff;color:#000;box-decoration-break:clone;-webkit-box-decoration-break:clone;padding:0 .75rem;width:fit-content}@media screen and (max-width: 640px){.header{position:relative;bottom:0;left:0;width:fit-content;max-width:none;margin-top:1rem}.article-h1{display:inline;background-color:transparent;padding:0;color:#fff}.article-info{display:block;background-color:transparent;padding:0;color:#fff}}code:not(.astro-code code){background-color:#353535;padding:.125rem .25rem;font-size:.925rem}.article-image{width:100%;height:auto;z-index:1}.end-of-article{margin-top:1rem;margin-bottom:1.5rem;width:100%;height:1px;background-color:#353535;border:none}blockquote{border-left:2px solid var(--primary);padding:.75rem 1rem;margin-left:0;background-color:rgba(var(--primary-rgb),.25);width:100%}blockquote p{margin-top:0;margin-bottom:0}table{margin-top:1rem;text-align:left;border-spacing:0;border-collapse:collapse}table th{padding:.5rem 1.5rem .5rem 0;border-bottom:1px solid #353535}table tbody{margin-top:1rem}table tbody tr{border-bottom:1px solid #353535}table tbody tr td{padding:.5rem 1.5rem .5rem 0}
.glow-image[data-astro-cid-lwpf7n2j]{position:relative}.glow-image[data-astro-cid-lwpf7n2j] img[data-astro-cid-lwpf7n2j]{position:relative;z-index:1}.glow[data-astro-cid-lwpf7n2j]{position:absolute!important;top:0;left:0;z-index:0!important;filter:blur(8px)}
.card[data-astro-cid-dohjnao5]{width:100%;height:auto;background-color:#1c1c1c;border:.09rem solid #11ff00;padding:1.5rem;overflow:hidden;border-radius:1rem}
</style>
<link rel="stylesheet" href="/_astro/blog.ZYuRKE3i.css">
<style>.toc-card ol{padding:0;display:flex;flex-direction:column;gap:.5rem;margin-bottom:0;list-style-type:none;position:relative}.toc-card ol li a{color:#c7c7c7;font-size:.925rem;padding:.25rem .5rem;box-decoration-break:clone;-webkit-box-decoration-break:clone}.toc-card ol li a:hover{color:#fff;text-decoration:none}.toc-card ol li a.active{color:#fff;background:var(--primary)}.left{height:100%;position:relative}.toc-card{position:sticky;top:2rem}article{display:flex;flex-direction:column;gap:2rem}.comments *{border-color:#353535!important}@media screen and (max-width: 640px){article{gap:1rem}}
</style></head> <body> <main> <nav data-astro-cid-5blmo7yk> <a class="site-title" href="/" data-astro-cid-5blmo7yk>Mian</a> <ul data-astro-cid-5blmo7yk> <li data-astro-cid-5blmo7yk> <a href="/blog" class="active" data-astro-cid-5blmo7yk>Blog</a> </li> <li class="nav-separator" data-astro-cid-5blmo7yk>/</li> <li data-astro-cid-5blmo7yk> <a href="/projects" data-astro-cid-5blmo7yk>Projects</a> </li> <li class="nav-separator" data-astro-cid-5blmo7yk>/</li> <li data-astro-cid-5blmo7yk> <input id="search" type="text" placeholder="Search (Ctrl+K)" data-astro-cid-5blmo7yk> <div id="search-results" data-astro-cid-5blmo7yk></div> </li> </ul> <button class="mobile-nav-toggle" data-astro-cid-5blmo7yk> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="menu-closed" data-astro-cid-5blmo7yk="true"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12h16M4 18h16M4 6h16"/></svg> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="menu-open" data-astro-cid-5blmo7yk="true"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 6L6 18M6 6l12 12"/></svg> </button> </nav> <script>
  const searchElement = document.querySelector('#search');
  const results = document.querySelector('#search-results');
  const navToggle = document.querySelector('.mobile-nav-toggle');

  let focusIndex = -1;

  document.addEventListener('keydown', (e) => {
    if (e.key === 'k' && e.ctrlKey) {
      searchElement.focus();
    }

    if (e.key === 'Escape') {
      searchElement.blur();
      results.classList.remove('active');
      focusIndex = -1;
    }

    if (e.key === 'ArrowDown') {
      e.preventDefault();

      focusIndex++;
      const results = document.querySelectorAll('#search-results a');

      if (focusIndex >= results.length) {
        focusIndex = 0;
      }

      results[focusIndex]?.focus();
    }

    if (e.key === 'ArrowUp') {
      e.preventDefault();

      focusIndex--;
      const results = document.querySelectorAll('#search-results a');

      if (focusIndex < 0) {
        focusIndex = results.length - 1;
      }

      results[focusIndex]?.focus();
    }
  });

  searchElement?.addEventListener('focus', () => {
    searchElement.placeholder = '';
    results.classList.add('active');
  });

  searchElement?.addEventListener('blur', () => {
    searchElement.placeholder = 'Search (Ctrl+K)';
  });

  searchElement?.addEventListener('blur', () => {
    setTimeout(() => {
      if (!document.activeElement?.closest('#search-results')) {
        results.classList.remove('active');
        focusIndex = -1;
      }
    }, 1);
  });

  results?.addEventListener('focusout', (e) => {
    if (!e.relatedTarget?.closest('#search-results')) {
      results.classList.remove('active');
      focusIndex = -1;
    }
  });

  searchElement?.addEventListener('input', async (e) => {
    if (e.target.dataset.loaded !== 'true') {
      e.target.dataset.loaded = 'true';

      window.pagefind = await import("/pagefind/pagefind.js");
    }

    results.innerHTML = '';

    const search = await window.pagefind.search(e.target.value);

    let i = 0;
    for (const result of search.results) {
      i++;

      const data = await result.data();
      
      results.innerHTML += `
        <a href="${data.url}">
          <h3 class="no-mt">${data.meta.title}</h3>
          <p>${data.excerpt}</p>
        </a>
        ${i < search.results.length ? '<hr class="separator">' : ''}
      `;
    }

    if (search.results.length === 0 && e.target.value.length > 0) {
      results.innerHTML = '<p style="margin-top: 0;">No results found</p>';
    }

    results.classList.add('active');
  });

  navToggle?.addEventListener('click', () => {
    navToggle.classList.toggle('active');
    document.querySelector('nav').classList.toggle('active');
  });

  const handleTabletChange = () => {
    if (window.matchMedia('(max-width: 640px)').matches) {
      searchElement.placeholder = 'Search';
    } else {
      searchElement.placeholder = 'Search (Ctrl+K)';
    }
  }

  document.addEventListener('DOMContentLoaded', handleTabletChange);
  document.addEventListener('resize', handleTabletChange);
</script>   <div class="layout-grid" data-astro-cid-cgyg4spe> <div class="left"> <div class="card toc-card" data-astro-cid-dohjnao5>  <h2 class="no-mt">Table of contents</h2> <ol> <li class="toc-li"> <a href="#_top" class="active">The Art of Account Lockouts</a> </li> <li class="toc-li" data-depth="2"> <a href="#introduction-what-is-a-lockout-attack">Introduction: “What Is a Lockout Attack?”</a> </li><li class="toc-li" data-depth="2"> <a href="#attack-categories">Attack Categories</a> </li><li class="toc-li" data-depth="3"> <a href="#lockout-via-repeated-login-attempts">Lockout via Repeated Login Attempts</a> </li><li class="toc-li" data-depth="4"> <a href="#lockout-escalation-via-brute-force">Lockout Escalation via Brute Force</a> </li><li class="toc-li" data-depth="4"> <a href="#what-i-found">What I Found:</a> </li><li class="toc-li" data-depth="4"> <a href="#weak-fingerprinting--permanent-lockout">Weak Fingerprinting = Permanent Lockout</a> </li><li class="toc-li" data-depth="4"> <a href="#what-i-found-1">What I Found:</a> </li><li class="toc-li" data-depth="4"> <a href="#key-notes">Key Notes</a> </li><li class="toc-li" data-depth="3"> <a href="#premature-email-sign-up">Premature Email Sign-Up</a> </li><li class="toc-li" data-depth="4"> <a href="#scenario">Scenario</a> </li><li class="toc-li" data-depth="3"> <a href="#lockout-via-injected-logout-request-img-srclogout">Lockout via Injected Logout Request (&lt;img src=&quot;/logout&quot;&gt;)</a> </li><li class="toc-li" data-depth="3"> <a href="#lockout-via-client-side-redirect-from-broken-pages">Lockout via Client-Side Redirect from Broken Pages</a> </li><li class="toc-li" data-depth="3"> <a href="#lockout-via-oversized-payloads-the-infamous-aaaa-attack">Lockout via Oversized Payloads (The Infamous AAAA... Attack)</a> </li><li class="toc-li" data-depth="3"> <a href="#conclusion-lockout-isnt-always-about-rate-limits">Conclusion: Lockout Isn’t Always About Rate Limits</a> </li> </ol>  </div>  </div> <article data-pagefind-body> <div class="card" data-astro-cid-dohjnao5>  <div class="article-header" id="_top" data-pagefind-ignore> <div class="glow-image" data-astro-cid-lwpf7n2j> <img src="/_astro/lock.BEAaoYfG_1e8etG.webp" alt="The Art of Account Lockouts" data-astro-cid-lwpf7n2j="true" width="275" height="183" loading="lazy" decoding="async" class="article-image"> <img src="/_astro/lock.BEAaoYfG_131gSg.webp" alt="The Art of Account Lockouts" data-astro-cid-lwpf7n2j="true" width="275" height="183" loading="lazy" decoding="async" class="article-image glow article-image"> </div>  <div class="header"> <div> <h1 class="no-mt article-h1">The Art of Account Lockouts</h1> </div> <div class="article-info"> <span>6/13/2025</span> <canvas id="bg-canvas" data-astro-cid-y3soregm></canvas> <canvas id="overlay-canvas" data-astro-cid-y3soregm></canvas>   <span>/</span> <span>6 minutes to read</span> <span>/</span> <span>Tags: business-logic, web, DoA</span> </div> </div> </div> <h2 id="introduction-what-is-a-lockout-attack">Introduction: “What Is a Lockout Attack?”</h2>
<p>Account lockout vulnerabilities let attackers intentionally trigger lockouts on a victim’s accounts, effectively locking them out. Depending on how login failures or resets are handled, this can cause real damage, especially in sensitive systems like banking or admin panels.</p>
<p>In this post, I’ll cover common and underrated techniques to exploit these bugs. They’re often missed in security reviews but show up in the wild more than you’d expect.</p>
<p>If you’re into bug hunting, grab a snack, this post will walk you through some sneaky, high-impact tricks that can lock users out without even touching their passwords.</p>
<h2 id="attack-categories">Attack Categories</h2>
<h3 id="lockout-via-repeated-login-attempts">Lockout via Repeated Login Attempts</h3>
<p>Some apps implement rate limiting to stop brute-force attacks, great in theory. But when it’s poorly done, it opens up a <strong>client-side DoA (Denial of Access (just made it up.))</strong> where an attacker can lock out users without touching their credentials.</p>
<p>The most common issue? Lockouts based <strong>only on the email address</strong>, ignoring IP, user-agent, etc. That means anyone can:</p>
<ul>
<li>Use a victim’s email</li>
<li>Send a few bad login attempts</li>
<li>Lock them out of their account</li>
</ul>
<p>If the unlock process is broken or hard to reach, or not present in the first place,  it’s game over.</p>
<hr/>
<h4 id="lockout-escalation-via-brute-force">Lockout Escalation via Brute Force</h4>
<p>While brute-forcing a login,  I noticed a rate limit. Most would stop,but I didn’t.</p>
<h4 id="what-i-found">What I Found:</h4>
<ul>
<li>Delay kept increasing: 10s → 1m → 30m</li>
<li>Eventually: <code>Account locked. Email sent to unlock.</code></li>
<li>But… the unlock <strong>didn’t work</strong>. It wasn’t tied to any account.</li>
</ul>
<p><strong>Severity:</strong> Medium<br/>
<strong>Why:</strong> Support could unlock it when requested.</p>
<hr/>
<h4 id="weak-fingerprinting--permanent-lockout">Weak Fingerprinting = Permanent Lockout</h4>
<p>This login endpoint had a 3s delay per attempt. I dug in.</p>
<h4 id="what-i-found-1">What I Found:</h4>
<ul>
<li>Lockout was tied <strong>only</strong> to email.</li>
<li>Ignored IP, user-agent, etc.</li>
<li>I could brute-force endlessly.</li>
<li>Victim was <strong>permanently locked out</strong> with no way to recover.</li>
</ul>
<p><strong>Severity:</strong> High<br/>
<strong>Why:</strong> No recovery path. A true denial-of-access.</p>
<hr/>
<h4 id="key-notes">Key Notes</h4>
<ul>
<li>
<p>Rate limiting should use multiple fingerprints:</p>
<ul>
<li>IP, User-Agent, Email, Geo (optional)</li>
</ul>
</li>
<li>
<p>Don’t stop at the first rate limit, <strong>push further</strong>.</p>
</li>
<li>
<p>Always test if recovery flows actually work.</p>
</li>
</ul>
<hr/>
<p><strong>Onto the next one : )</strong></p>
<h3 id="premature-email-sign-up">Premature Email Sign-Up</h3>
<p>Some platforms enforce email verification, but still <strong>register an email address before it’s verified</strong>. This can lead to <strong>premature account lockouts</strong>.</p>
<p>An attacker can abuse this by pre-registering someone else’s email, especially <strong>company emails</strong> effectively blocking them from signing up later.</p>
<hr/>
<h4 id="scenario">Scenario</h4>
<p>You see a LinkedIn post: a company announces they’ll start using platform XYZ (which is vulnerable to this issue).</p>
<p>You act fast and pre-register <strong>common emails</strong> like:</p>
<ul>
<li><code>admin@company.com</code></li>
<li><code>dev@company.com</code></li>
<li><code>info@company.com</code></li>
</ul>
<p>Now, those addresses are either locked in a pending state or blocked due to failed verifications.</p>
<p>If the platform has no solid support flow or cleanup logic, this leads to:</p>
<ul>
<li>Frustration for real users</li>
<li>Failed onboarding for the company</li>
<li><strong>Client trust loss</strong> for the platform</li>
</ul>
<blockquote>
<p>Surprisingly, this is still common in production apps.</p>
</blockquote>
<h3 id="lockout-via-injected-logout-request-img-srclogout">Lockout via Injected Logout Request <code>(&lt;img src=&quot;/logout&quot;&gt;)</code></h3>
<p>Some apps let users insert links or images in their profile, chat, or shared workspace. In dev-focused apps (like code playgrounds, preview tools, or collaboration platforms), you can often link to a user profile or embed assets like images via URL. If the app has a <strong>logout endpoint that accepts GET requests</strong> (i.e., vulnerable to logout CSRF), you can abuse this by injecting something like <code>&lt;img src=&quot;/logout&quot;&gt;</code> into any field that renders HTML, bios, team pages, shared projects, etc.</p>
<p>Now if a victim loads that page, the browser will auto-trigger the logout. <strong>Bonus:</strong> if the app allows profile linking, team pages, or has self-XSS, you can escalate this by injecting the logout call into your own profile and trick the victim into viewing it (e.g., by linking their account to yours). Every time their dashboard loads your profile, boom, auto logout.</p>
<p>💡 <em>If you ever spot a logout CSRF, immediately look for user-controlled link points. That’s where the fun begins.</em></p>
<hr/>
<h3 id="lockout-via-client-side-redirect-from-broken-pages">Lockout via Client-Side Redirect from Broken Pages</h3>
<p>Some apps automatically redirect users from broken or missing pages to a fallback like <code>/</code>, <code>/dashboard</code>, or <code>/home</code>. These redirects are often handled <strong>client-side using JavaScript</strong>, triggered when a user visits a non-existent route like:</p>
<p><code>https://example.com/user/attacker-profile</code></p>
<p>Now let’s say the app doesn’t has a logout CSRF — good on them. But if <strong>a broken link redirects to <code>/</code></strong>, and you find an injection point (like a <strong>profile bio</strong>, <strong>team page</strong>, or <strong>image <code>src</code></strong>), you can trap users into an <strong>in-app redirect chain</strong>.</p>
<p>Any time the victim loads your crafted content, they hit the redirect → get kicked back to home → and the process can repeat if the redirect chain is re-triggered via stored state, like:</p>
<ul>
<li>links stored in memory or session</li>
<li>profile preview components</li>
<li>auto-triggered image <code>src=/</code> or script paths</li>
</ul>
<p>Even if they log in again or clear cookies, the redirect re-triggers — effectively locking them out until the malicious content is removed.</p>
<p>This works great in <strong>collaboration tools</strong>, <strong>shared dashboards</strong>, or <strong>apps that render user-controlled paths</strong></p>
<hr/>
<h3 id="lockout-via-oversized-payloads-the-infamous-aaaa-attack">Lockout via Oversized Payloads (The Infamous <code>AAAA...</code> Attack)</h3>
<p>This one’s a hybrid, part client-side, part server-triggered DoA.</p>
<p>Some web apps don’t properly handle <strong>overly long inputs</strong> like giant query params, huge route names, or absurd form values (e.g., <code>/profile/AAAAAAAAA...</code>). When these values are reflected back into the page ,in the DOM, in script tags, or in input fields — the browser starts to choke.</p>
<p><strong>You get:</strong></p>
<ul>
<li>Page freezes</li>
<li>Memory spikes</li>
<li>Infinite rendering attempts</li>
<li>Total browser crash</li>
</ul>
<p>Even worse: if you can <strong>store</strong> these payloads somewhere like a profile name, chat message, or shared project route, then any user who opens that page <strong>bricks their own browser</strong>.</p>
<p><strong>Common abuse vectors:</strong></p>
<ul>
<li>Injected script route: <code>/user/&lt;huge_string&gt;</code></li>
<li>Input fields pre-filled with massive values</li>
<li><code>&lt;title&gt;</code> or <code>&lt;script&gt;</code> injections that endlessly expand</li>
</ul>
<p><strong>This is especially effective in:</strong></p>
<ul>
<li>Single Page Apps (SPA) where routes are client-controlled.</li>
<li>Apps with SSR (Server-Side Rendering) that reflect user input.</li>
<li>Places where user-generated content is previewed on page load.</li>
</ul>
<p><em>Used in forum nukes, Discord crash videos, and even API DoS payloads. Surprisingly still alive in modern apps.</em></p>
<h3 id="conclusion-lockout-isnt-always-about-rate-limits">Conclusion: Lockout Isn’t Always About Rate Limits</h3>
<p>Client-side lockouts are underrated and underexplored. While login attempt limits and rate limiting are the obvious ones, real damage often comes from creative abuse of features:</p>
<ul>
<li>
<p><strong>Cookie bombing</strong>: Reflecting <code>Set-Cookie</code> headers to fill up browser storage and break sessions.</p>
</li>
<li>
<p><strong>Self-XSS</strong>: Getting a victim to execute your payload that logs them into your account, stores broken session data, and bricks their access.</p>
</li>
<li>
<p><strong>Persistent state DoA</strong>: Using stored routes, profiles, or previews to keep triggering logouts, redirects, or crashes every time the app loads.</p>
</li>
</ul>
<p>These are just a few of the tricks I’ve used or seen in the wild. The real fun begins when you start thinking in <strong>weird, user-specific edge cases</strong>.</p>
<hr/>
<p>Got your own twist on client-side lockouts?
Hit me up on <strong>Discord</strong>. I’d love to expand this list or collab on weird bugs.</p>
<p><strong>Stay sharp. Stay annoying. Happy Hacking</strong></p> <hr class="end-of-article"> <a href="/blog" class="block-link" data-pagefind-ignore>← Back to blog</a>  </div>   </article> </div>   </main> <canvas id="bg-canvas" data-astro-cid-y3soregm></canvas> <canvas id="overlay-canvas" data-astro-cid-y3soregm></canvas> <script type="module" src="/_astro/Background.astro_astro_type_script_index_0_lang.D6Pa6l4d.js"></script>  </body></html> <script type="module">const s=document.querySelectorAll(".toc-li a"),c=document.querySelectorAll("#_top, article h1, article h2, article h3, article h4"),n=new Map;for(const t of s){const e=t.href.split("#")[1],o=document.getElementById(e);o&&n.set(o,t)}function l(t){const e=t.getBoundingClientRect(),o=Math.max(document.documentElement.clientHeight,window.innerHeight);return!(e.bottom<0||e.top-o>=0)}const r=new IntersectionObserver(()=>{let t=null;for(const e of c){const o=l(e),i=n.get(e);if(o){i&&i.classList.add("active"),t||(t=e);break}}if(t){for(const e of n.keys())if(e!==t){const o=n.get(e);o&&o.classList.remove("active")}}},{threshold:0,root:null,rootMargin:"0px"});for(const t of c)r.observe(t);</script> 